(function(t){function e(e){for(var n,s,o=e[0],l=e[1],u=e[2],m=0,d=[];m<o.length;m++)s=o[m],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);c&&c(e);while(d.length)d.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(n=!1)}n&&(i.splice(e--,1),t=s(s.s=a[0]))}return t}var n={},r={app:0},i=[];function s(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=n,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(a,n,function(e){return t[e]}.bind(null,n));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var u=0;u<o.length;u++)e(o[u]);var c=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("85ec"),r=a.n(n);r.a},"13aa":function(t,e,a){"use strict";var n=a("7e11"),r=a.n(n);r.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("4989"),a("ab8b");var n=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("nav",{staticClass:"navbar navbar-expand-lg navbar-light bg-light"},[a("div",{staticClass:"container"},[a("div",{staticClass:"collapse navbar-collapse"},[a("router-link",{staticClass:"navbar-brand mr-auto",attrs:{to:"/"}},[t._v("Music Store")]),a("ul",{staticClass:"navbar-nav"},[a("cart-nav",{attrs:{"cart-total":t.cartTotal}}),a("li",{staticClass:"nav-item dropdown"},[a("a",{staticClass:"nav-link dropdown-toggle",attrs:{id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t.currentUser?[t._v(" "+t._s(t.currentUser)+" ")]:t._e(),a("font-awesome-icon",{attrs:{icon:["fas","user-circle"],size:"lg"}})],2),a("div",{staticClass:"dropdown-menu dropdown-menu-right",attrs:{"aria-labelledby":"navbarDropdown"}},[t.currentUser?a("a",{staticClass:"dropdown-item",attrs:{href:"/logout"}},[t._v("Logout")]):a("a",{staticClass:"dropdown-item",attrs:{href:"/login.html"}},[t._v("Login")])])])],1)],1)])]),a("router-view",{attrs:{currentUser:t.currentUser}})],1)},i=[],s=(a("13d5"),a("9a2e")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("li",{staticClass:"nav-item"},[a("router-link",{staticClass:"nav-link",attrs:{to:"/cart"}},[a("font-awesome-icon",{attrs:{icon:["fas","shopping-cart"],size:"lg"}}),t.cartTotal>0?a("span",{staticClass:"badge badge-dark"},[t._v(t._s(t.cartTotal))]):t._e()],1)],1)},l=[],u=(a("a9e3"),{name:"cartNav",props:{cartTotal:Number}}),c=u,m=a("2877"),d=Object(m["a"])(c,o,l,!1,null,null,null),v=d.exports,f=a("74ca"),b=a("478e"),h=a("2bf2"),p={query:{fetchPolicy:"no-cache",errorPolicy:"all"}},g=Object(b["a"])({uri:"/graphql",credentials:"same-origin"}),_=new f["a"]({cache:new h["a"],link:g,defaultOptions:p}),w=_,y=a("9530"),C=a.n(y);function $(){var t=Object(s["a"])(["\n  {\n    currentUser\n  }\n"]);return $=function(){return t},t}function O(){var t=Object(s["a"])(["\n  {\n    cart {\n      items {\n        quantity\n      }\n    }\n  }\n"]);return O=function(){return t},t}var j=C()(O()),x=C()($()),k={name:"App",components:{CartNav:v},data:function(){return{currentUser:null,cartTotal:0}},created:function(){this.fetchCurrentUser(),this.$on("update-cart",this.updateCart)},methods:{fetchCurrentUser:function(){var t=this;w.query({query:x}).then((function(e){t.currentUser=e.data.currentUser,t.currentUser&&t.fetchCartTotal()})).catch((function(t){console.error(t)}))},fetchCartTotal:function(){var t=this;w.query({query:j}).then((function(e){var a=e.data.cart.items;t.cartTotal=a.reduce((function(t,e){return t+e.quantity}),0)})).catch((function(t){console.error(t)}))},updateCart:function(t){this.cartTotal=t}}},q=k,T=(a("034f"),Object(m["a"])(q,r,i,!1,null,null,null)),D=T.exports,I=a("8c4f"),S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("h2",[t._v("All genres")]),t.loading?a("div",[t._v(" Loading... ")]):t._e(),t.error?a("div",{staticClass:"alert alert-danger"},[t._v(" "+t._s(t.error)+" ")]):t._e(),t.genres?a("div",{staticClass:"row"},t._l(t.genres,(function(t,e){return a("GenreCard",{key:t.id,attrs:{genre:t,index:e}})})),1):t._e()])},U=[],E=(a("d3b7"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card",staticStyle:{width:"18rem"}},[a("img",{staticClass:"card-img-top",attrs:{src:"/images/genres/"+t.genre.image,alt:t.genre.name}}),a("div",{staticClass:"card-body bg-light"},[a("h5",{staticClass:"card-title"},[t._v(t._s(t.genre.name))]),a("router-link",{staticClass:"btn btn-primary",attrs:{to:"/genre/"+t.genre.id}},[t._v("Explore")])],1)])}),F=[],R={name:"GenreCard",props:{genre:Object}},P=R,A=Object(m["a"])(P,E,F,!1,null,null,null),L=A.exports;function Q(){var t=Object(s["a"])(["\n  {\n    genres {\n      id\n      name\n      image\n    }\n  }\n"]);return Q=function(){return t},t}var N=C()(Q()),M={name:"home",data:function(){return{loading:!1,genres:null,error:null}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;this.error=this.genres=null,this.loading=!0,w.query({query:N}).then((function(e){t.genres=e.data.genres})).catch((function(e){console.error(e),t.error="Failed to load data..."})).finally((function(){t.loading=!1}))}},components:{GenreCard:L}},G=M,z=Object(m["a"])(G,S,U,!1,null,null,null),J=z.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("h2",[t._v("Albums")]),t.loading?a("div",[t._v(" Loading... ")]):t._e(),t.error?a("div",{staticClass:"alert alert-danger"},[t._v(" "+t._s(t.error)+" ")]):t._e(),t.albums?a("div",{staticClass:"row"},t._l(t.albums,(function(t,e){return a("AlbumCard",{key:t.id,attrs:{album:t,index:e}})})),1):t._e()])},H=[],K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card",staticStyle:{width:"18rem"}},[a("img",{staticClass:"card-img-top",attrs:{src:"/images/albums/"+t.album.image,alt:t.album.name}}),a("div",{staticClass:"card-body bg-light"},[a("h5",{staticClass:"card-title"},[t._v(t._s(t.album.name))]),a("p",{staticClass:"card-text text-right"},[a("Stars",{attrs:{rating:t.album.rating}})],1),a("router-link",{staticClass:"btn btn-primary",attrs:{to:"/album/"+t.album.id}},[t._v("Explore")])],1)])},V=[],W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",[t._v(" "+t._s(t.rating)+" / 5 "),t.rating<1?a("span",[a("font-awesome-icon",{attrs:{icon:["far","star"]}})],1):a("span",t._l(this.rating,(function(t){return a("font-awesome-icon",{key:t,staticClass:"text-warning",attrs:{icon:["fas","star"]}})})),1)])},X=[],Y={name:"Stars",props:{rating:Number}},Z=Y,tt=Object(m["a"])(Z,W,X,!1,null,null,null),et=tt.exports,at={name:"AlbumCard",components:{Stars:et},props:{album:Object}},nt=at,rt=Object(m["a"])(nt,K,V,!1,null,null,null),it=rt.exports;function st(){var t=Object(s["a"])(["\n  query ($genre: ID!) {\n    albums(genre: $genre) {\n      id\n      name\n      artist\n      image\n      rating\n    }\n  }\n"]);return st=function(){return t},t}var ot=C()(st()),lt={name:"genre",data:function(){return{loading:!1,albums:null,error:null}},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{fetchData:function(){var t=this;this.error=this.albums=null,this.loading=!0,w.query({query:ot,variables:{genre:this.$route.params.id}}).then((function(e){t.albums=e.data.albums})).catch((function(e){console.error(e),t.error="Failed to load data..."})).finally((function(){t.loading=!1}))}},components:{AlbumCard:it}},ut=lt,ct=Object(m["a"])(ut,B,H,!1,null,null,null),mt=ct.exports,dt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[t.loading?a("div",[t._v(" Loading... ")]):t._e(),t.error?a("div",{staticClass:"alert alert-danger"},[t._v(" "+t._s(t.error)+" ")]):t._e(),t.album?[a("div",{staticClass:"media"},[a("img",{staticClass:"align-self-start mr-5",attrs:{src:"/images/albums/"+t.album.image,alt:t.album.name}}),a("div",{staticClass:"media-body"},[a("h2",[t._v(t._s(t.album.name))]),a("p",{staticClass:"text-secondary"},[t._v(t._s(t.album.artist)+", "+t._s(t.album.genre.name))]),a("p",[a("Stars",{attrs:{rating:t.rating}}),t.showReviews()?[t._v(" - "),a("a",{attrs:{href:"#reviews"}},[t._v("Reviews")])]:t._e()],2),t.currentUser?a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.addToCart()}}},[t._v("Add to cart")]):t._e()])]),a("TrackList",{attrs:{album:t.album}})]:t._e(),t.showReviews()?[a("hr"),a("h3",[t._v("Reviews")]),a("div",{attrs:{id:"reviews"}},[t.review.errors.length?[a("p",[t._v("Please correct the following error(s):")]),a("ul",t._l(t.review.errors,(function(e,n){return a("li",{key:n},[t._v(t._s(e))])})),0)]:t._e(),a("form",{staticClass:"form-inline",attrs:{id:"reviewForm"},on:{submit:function(e){return e.preventDefault(),t.checkForm(e)}}},[a("label",{staticClass:"mb-2 mr-sm-2 sr-only",attrs:{for:"reviewComment"}},[t._v("Comment")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.review.comment,expression:"review.comment"}],staticClass:"form-control mb-2 mr-sm-2",attrs:{id:"reviewComment",placeholder:"Enter comment"},domProps:{value:t.review.comment},on:{input:function(e){e.target.composing||t.$set(t.review,"comment",e.target.value)}}}),a("label",{staticClass:"mb-2 mr-sm-2",attrs:{for:"reviewRating"}},[t._v("Rating")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.review.rating,expression:"review.rating"}],staticClass:"custom-select mb-2 mr-sm-2",attrs:{id:"reviewRating"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.review,"rating",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"1"}},[t._v("1")]),a("option",{attrs:{value:"2"}},[t._v("2")]),a("option",{attrs:{value:"3"}},[t._v("3")]),a("option",{attrs:{value:"4"}},[t._v("4")]),a("option",{attrs:{value:"5"}},[t._v("5")])]),a("button",{staticClass:"btn btn-primary mb-2 mr-sm-2",attrs:{type:"submit",form:"reviewForm"}},[t._v("Submit")])]),t.reviews?a("div",{staticClass:"row"},t._l(t.reviews,(function(t,e){return a("ReviewCard",{key:e,attrs:{review:t}})})),1):t._e()],2)]:t._e()],2)},vt=[],ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("h3",[t._v("Tracks")]),a("table",{staticClass:"table"},[t._m(0),a("tbody",t._l(t.album.tracks,(function(e){return a("tr",{key:e.number},[a("th",{attrs:{scope:"row"}},[t._v(t._s(e.number))]),a("td",[t._v(t._s(e.name))])])})),0)])])},bt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"thead-light"},[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("#")]),a("th",{attrs:{scope:"col"}},[t._v("Name")])])])}],ht={name:"TrackList",props:{album:Object}},pt=ht,gt=Object(m["a"])(pt,ft,bt,!1,null,null,null),_t=gt.exports,wt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card",staticStyle:{width:"18rem"}},[a("div",{staticClass:"card-body bg-light"},[a("p",{staticClass:"card-text"},[a("Stars",{attrs:{rating:t.review.rating}}),t._v(" "),a("span",{staticClass:"text-secondary"},[t._v(t._s(t.review.name))])],1),a("p",{staticClass:"card-text"},[t._v(t._s(t.review.comment))])])])},yt=[],Ct={name:"ReviewCard",props:{review:Object},components:{Stars:et}},$t=Ct,Ot=Object(m["a"])($t,wt,yt,!1,null,null,null),jt=Ot.exports;function xt(){var t=Object(s["a"])(["\n  mutation ($albumId: ID!) {\n    addToCart(albumId: $albumId) {\n      items {\n        quantity\n      }\n    }\n  }\n"]);return xt=function(){return t},t}function kt(){var t=Object(s["a"])(["\n  mutation ($albumId: ID!, $review: ReviewInput!) {\n    addReview(albumId: $albumId, review: $review) {\n      rating\n      reviews {\n        name\n        rating\n        comment\n      }\n    }\n  }\n"]);return kt=function(){return t},t}function qt(){var t=Object(s["a"])(["\n  query ($id: ID!) {\n    album(id: $id) {\n      id\n      name\n      genre {\n        name\n      }\n      artist\n      image\n      rating\n      tracks {\n        number\n        name\n      }\n      reviews {\n        name\n        rating\n        comment\n      }\n    }\n  }\n"]);return qt=function(){return t},t}var Tt=C()(qt()),Dt=C()(kt()),It=C()(xt()),St={name:"album",data:function(){return{loading:!1,album:null,rating:null,reviews:null,review:{errors:[],comment:null,rating:null},error:null}},props:{currentUser:String},created:function(){this.fetchData()},watch:{$route:"fetchData"},methods:{showReviews:function(){return this.reviews||this.currentUser},fetchData:function(){var t=this;this.error=this.album=this.rating=this.reviews=null,this.loading=!0,w.query({query:Tt,variables:{id:this.$route.params.id}}).then((function(e){t.album=e.data.album,t.rating=t.album.rating,t.reviews=t.album.reviews&&t.album.reviews.length>0?t.album.reviews:null})).catch((function(e){console.error(e),t.error="Failed to load data..."})).finally((function(){t.loading=!1}))},addToCart:function(){var t=this;w.mutate({mutation:It,variables:{albumId:this.$route.params.id}}).then((function(e){var a=e.data.addToCart.items,n=a.reduce((function(t,e){return t+e.quantity}),0);window.alert("Done!"),t.$parent.$emit("update-cart",n)})).catch((function(t){console.error(t)}))},checkForm:function(){this.review.errors=[],this.review.rating?this.sendForm():this.review.rating||this.review.errors.push("Rating required.")},sendForm:function(){var t=this;w.mutate({mutation:Dt,variables:{albumId:this.$route.params.id,review:{rating:this.review.rating,comment:this.review.comment}}}).then((function(e){var a=e.data.addReview;t.rating=a.rating,t.reviews=a.reviews})).catch((function(t){console.error(t)})),this.review.rating=this.review.comment=null}},components:{TrackList:_t,Stars:et,ReviewCard:jt}},Ut=St,Et=Object(m["a"])(Ut,dt,vt,!1,null,null,null),Ft=Et.exports,Rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[t.loading?a("div",[t._v(" Loading... ")]):t._e(),t.error?a("div",{staticClass:"alert alert-danger"},[t._v(" "+t._s(t.error)+" ")]):t._e(),t.items&&t.items.length>0?a("table",{staticClass:"table"},[t._m(0),a("tbody",t._l(t.items,(function(e){return a("tr",{key:e.album.id},[a("td",[a("div",{staticClass:"media"},[a("router-link",{attrs:{to:"/album/"+e.album.id}},[a("img",{staticClass:"align-self-start mr-5 cart-album",attrs:{src:"/images/albums/"+e.album.image,alt:e.album.name}})]),a("div",{staticClass:"media-body"},[a("h5",{staticClass:"mt-0"},[a("router-link",{attrs:{to:"/album/"+e.album.id}},[t._v(t._s(e.album.name))])],1),a("p",{staticClass:"text-secondary"},[t._v(t._s(e.album.artist)+", "+t._s(e.album.genre.name))])])],1)]),a("td",[t._v(t._s(e.quantity))]),a("td",[a("button",{staticClass:"btn btn-primary mr-2",attrs:{type:"button"},on:{click:function(a){return t.addOne(e.album.id)}}},[t._v("Add one")]),a("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:function(a){return t.removeOne(e.album.id)}}},[t._v("Remove one")])])])})),0)]):t.currentUser?[t._v(" Cart is empty ")]:[t._v(" Please log in ")]],2)},Pt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",{attrs:{scope:"col"}},[t._v("Album")]),a("th",{attrs:{scope:"col"}},[t._v("Quantity")]),a("th",{attrs:{scope:"col"}},[t._v("Actions")])])])}];function At(){var t=Object(s["a"])(["\n  mutation ($albumId: ID!) {\n    removeFromCart(albumId: $albumId) {\n      items {\n        album {\n          id\n          name\n          artist\n          genre {\n            name\n          }\n          image\n        }\n        quantity\n      }\n    }\n  }\n"]);return At=function(){return t},t}function Lt(){var t=Object(s["a"])(["\n  mutation ($albumId: ID!) {\n    addToCart(albumId: $albumId) {\n      items {\n        album {\n          id\n          name\n          artist\n          genre {\n            name\n          }\n          image\n        }\n        quantity\n      }\n    }\n  }\n"]);return Lt=function(){return t},t}function Qt(){var t=Object(s["a"])(["\n  {\n    cart {\n      items {\n        album {\n          id\n          name\n          artist\n          genre {\n            name\n          }\n          image\n        }\n        quantity\n      }\n    }\n  }\n"]);return Qt=function(){return t},t}var Nt=C()(Qt()),Mt=C()(Lt()),Gt=C()(At()),zt={name:"cart",data:function(){return{loading:!1,items:null,error:null}},props:{currentUser:String},created:function(){this.fetchData()},watch:{$route:"fetchData",currentUser:"fetchData"},methods:{fetchData:function(){var t=this;this.currentUser&&(this.beforeQuery(),w.query({query:Nt}).then((function(e){t.items=e.data.cart.items})).catch(this.handleFailure).finally(this.afterQuery))},addOne:function(t){var e=this;this.beforeQuery(),w.mutate({mutation:Mt,variables:{albumId:t}}).then((function(t){e.items=t.data.addToCart.items,e.updateCartTotal()})).catch(this.handleFailure).finally(this.afterQuery)},removeOne:function(t){var e=this;this.beforeQuery(),w.mutate({mutation:Gt,variables:{albumId:t}}).then((function(t){e.items=t.data.removeFromCart.items,e.updateCartTotal()})).catch(this.handleFailure).finally(this.afterQuery)},updateCartTotal:function(){var t=this.items.reduce((function(t,e){return t+e.quantity}),0);this.$parent.$emit("update-cart",t)},beforeQuery:function(){this.error=this.items=null,this.loading=!0},handleFailure:function(t){console.error(t),this.error="Failed to load data..."},afterQuery:function(){this.loading=!1}}},Jt=zt,Bt=(a("13aa"),Object(m["a"])(Jt,Rt,Pt,!1,null,"595a9d2e",null)),Ht=Bt.exports;n["a"].use(I["a"]);var Kt=[{path:"/",name:"home",component:J},{path:"/genre/:id",name:"genre",component:mt},{path:"/album/:id",name:"album",component:Ft},{path:"/cart",name:"cart",component:Ht}],Vt=new I["a"]({mode:"history",routes:Kt}),Wt=Vt,Xt=a("ecee"),Yt=a("b702"),Zt=a("c074"),te=a("ad3d");Xt["c"].add(Zt["c"],Yt["a"],Zt["b"],Zt["a"]),n["a"].component("font-awesome-icon",te["a"]),n["a"].config.productionTip=!1,new n["a"]({router:Wt,render:function(t){return t(D)}}).$mount("#app")},"7e11":function(t,e,a){},"85ec":function(t,e,a){}});
//# sourceMappingURL=app.3660d5cf.js.map